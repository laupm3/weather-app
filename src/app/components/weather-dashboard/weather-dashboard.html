<div class="dashboard-container" [ngClass]="getWeatherClass()">
    <div class="inner-content">
        <header class="dashboard-header">
            <div class="header-main">
                <h1>Weather Intelligence</h1>
                <div class="unit-toggle" (click)="toggleUnits()"
                    [title]="'Switch to ' + (units === 'metric' ? 'Fahrenheit' : 'Celsius')">
                    <span [class.active]="units === 'metric'">°C</span>
                    <div class="toggle-track">
                        <div class="toggle-thumb" [class.imperial]="units === 'imperial'"></div>
                    </div>
                    <span [class.active]="units === 'imperial'">°F</span>
                </div>
            </div>
            <app-search-bar (citySearch)="handleCitySearch($event)"></app-search-bar>

            <div *ngIf="favoriteWeatherData.length > 0" class="quick-access">
                <span class="section-label">Your Locations</span>
                <div class="fav-grid">
                    <div *ngFor="let fav of favoriteWeatherData" class="fav-tile" (click)="handleCitySearch(fav.name)">
                        <div class="tile-header">
                            <span class="tile-city">{{ fav.name }}</span>
                            <button class="tile-remove" (click)="removeFavorite(fav.name, $event)" title="Remove">
                                &times;
                            </button>
                        </div>
                        <div class="tile-body">
                            <img [src]="'https://openweathermap.org/img/wn/' + fav.weather[0].icon + '@2x.png'"
                                [alt]="fav.weather[0].description" class="tile-icon">
                            <div class="tile-temp-group">
                                <span class="tile-temp">{{ fav.main.temp | number:'1.0-0' }}°</span>
                                <span class="tile-units">{{ units === 'metric' ? 'C' : 'F' }}</span>
                                <span class="tile-desc">{{ fav.weather[0].description }}</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <main class="dashboard-content">
            <div *ngIf="loading" class="loader-container">
                <div class="loader"></div>
                <p>Analyzing weather data...</p>
            </div>

            <div *ngIf="error" class="error-message">
                {{ error }}
            </div>

            <div *ngIf="!loading && weatherData" class="weather-display">
                <app-weather-card [weatherData]="weatherData" [units]="units"></app-weather-card>
                <app-hourly-chart *ngIf="forecastData" [forecastData]="forecastData" [units]="units"></app-hourly-chart>
                <app-forecast *ngIf="forecastData" [forecastData]="forecastData" [units]="units"></app-forecast>
            </div>

            <div *ngIf="!loading && !weatherData && !error" class="welcome-message">
                <p>Ready to discover the weather?</p>
            </div>
        </main>
    </div>
</div>